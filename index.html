<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="City Life Economy Sim - A top-down sandbox simulation with finite resources and live economy chain">
  <meta name="theme-color" content="#0f1e1f">
  <meta property="og:title" content="City Life Economy Sim">
  <meta property="og:description" content="Manage a dynamic city with resource production, trading, and live economy">
  <meta property="og:type" content="website">
  <title>City Life Economy Sim</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üèòÔ∏è</text></svg>">
  <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <h1>City Life Sim</h1>
      <div class="subtitle">Top-down sandbox with finite resources and a live economy chain.</div>

      <div class="controls">
        <button id="addPersonBtn">Add Hero</button>
        <button id="removeSelectedBtn" class="danger">Remove Selected</button>
        <button id="removeRandomBtn" class="danger">Remove Random</button>
        <button id="newSimBtn">New Simulation</button>
        <button id="pauseBtn">Pause</button>
      </div>

      <div class="controls controls-two">
        <button id="saveBtn">Save</button>
        <button id="loadBtn">Load</button>
      </div>

      <div class="controls controls-three">
        <button id="speed1Btn" class="active">x1</button>
        <button id="speed3Btn">x3</button>
        <button id="speed6Btn">x6</button>
      </div>

      <div class="person-card">
        <h2>Player Strategy</h2>
        <div class="controls controls-two">
          <button id="strategyBalancedBtn" class="active">Balanced</button>
          <button id="strategyProfitBtn">Profit</button>
        </div>
        <div class="controls">
          <button id="strategySafeBtn">Safe</button>
        </div>
        <div class="mini" id="strategySummary">Balanced: heroes keep a mix of earnings and safety.</div>
      </div>

      <div class="person-card">
        <h2>Construction Plan</h2>
        <div class="controls controls-two">
          <button id="buildBalancedBtn" class="active">Balanced</button>
          <button id="buildMarketBtn">Market First</button>
        </div>
        <div class="controls controls-two">
          <button id="buildFarmBtn">Farm First</button>
          <button id="buildTownhallBtn">Townhall First</button>
        </div>
        <div class="mini" id="buildSummary">Balanced order with adaptive housing.</div>
      </div>

      <div class="controls">
        <button id="postChallengeBtn" class="hidden">Continue Sandbox</button>
      </div>

      <div class="controls">
        <button id="toolsMenuBtn">Tools</button>
      </div>
      <div class="person-card tools-panel hidden" id="toolsPanel">
        <h2>Resource Menu</h2>
        <div class="controls">
          <button id="worldSettingsBtn">World Settings</button>
        </div>
        <div class="controls controls-two">
          <button id="resourceMapBtn" class="active">Map</button>
          <button id="resourceWorldBtn">World</button>
        </div>
        <div class="mini" id="resourceList"></div>
      </div>

      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-label">Heroes</div>
          <div class="stat-value" id="popStat">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">City Stage</div>
          <div class="stat-value" id="stageStat" style="font-size: 15px;">Subsistence</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Day</div>
          <div class="stat-value" id="dayStat">1</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Bank Cash</div>
          <div class="stat-value" id="marketCashStat">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">World Money</div>
          <div class="stat-value" id="worldMoneyStat">0</div>
        </div>
      </div>

      <div class="legend">
        <div><b>Person Colors</b></div>
        <div id="professionLegend"></div>
      </div>

      <div class="small-note">
        Main goal: guide 4 heroes to earn as much money as possible in 5 years. If they ignore hunger and health for too long, they can die.
      </div>
    </aside>

    <main class="world-wrap">
      <canvas id="world"></canvas>
      <div class="overlay" id="overlayText"></div>
    </main>

    <aside class="rightbar">
      <div class="person-card" id="personCard">
        <h2>No person selected</h2>
        <div class="mini">Click any person on the map to inspect stats and needs.</div>
      </div>

      <div class="person-card" id="buildingCard">
        <h2>No object selected</h2>
        <div class="mini">Click any object on the map to inspect description and stats.</div>
      </div>

      <div class="person-card">
        <h2>Market Stocks</h2>
        <table class="table" id="marketTable"></table>
      </div>

      <div class="person-card">
        <h2>Challenge Scoring</h2>
        <div class="mini" id="scoreMeta">Score = earned + 35% cash + survival bonus.</div>
        <div class="mini" id="scoreBoard"></div>
      </div>

      <div class="person-card">
        <h2>Recent Events</h2>
        <div class="event-log" id="eventLog"></div>
      </div>
    </aside>
  </div>

  <div class="modal-backdrop hidden" id="worldSettingsModal">
    <div class="modal-window" role="dialog" aria-modal="true" aria-labelledby="worldSettingsTitle">
      <div class="modal-head">
        <h2 id="worldSettingsTitle">World Settings</h2>
        <button id="worldSettingsCloseBtn" class="danger">Close</button>
      </div>
      <div class="mini">Enable or disable simulation mechanics. Quantities are fixed by the game balance.</div>

      <div class="settings-section">
        <h3>Mechanics</h3>
        <div class="settings-grid">
          <label for="wsMechanicNeedsInput" title="Controls hunger, health decay, and death risk when needs are ignored.">Needs & health simulation</label>
          <input id="wsMechanicNeedsInput" type="checkbox">

          <label for="wsMechanicTradeInput" title="Allows buying/selling goods through the market and seller payouts.">Trading at market</label>
          <input id="wsMechanicTradeInput" type="checkbox">

          <label for="wsMechanicDynamicPricingInput" title="Prices react to demand/supply pressure instead of staying at base values.">Dynamic demand and prices</label>
          <input id="wsMechanicDynamicPricingInput" type="checkbox">

          <label for="wsMechanicJobRebalanceInput" title="Heroes can switch roles automatically to match city needs.">Auto job rebalance</label>
          <input id="wsMechanicJobRebalanceInput" type="checkbox">

          <label for="wsMechanicResourceRegenInput" title="Wild nodes and farm fertility slowly recover over time.">Resource regeneration</label>
          <input id="wsMechanicResourceRegenInput" type="checkbox">

          <label for="wsMechanicConstructionInput" title="Enables automatic city building progress based on available resources and treasury.">City construction progression</label>
          <input id="wsMechanicConstructionInput" type="checkbox">
        </div>
      </div>

      <div class="controls controls-two modal-actions">
        <button id="worldSettingsApplyBtn">Apply</button>
        <button id="worldSettingsApplySaveBtn">Apply + Save</button>
      </div>
    </div>
  </div>

  <script defer src="src/js/config.js"></script>
  <script defer src="src/js/camera.js"></script>
  <script defer src="src/js/storage.js"></script>
  <script defer src="src/js/game.js"></script>
</body>
</html>
